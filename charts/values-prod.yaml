# ========================================
# Production Environment Overrides
# ========================================

# Image tag for production
image:
  registry: registry.digitalocean.com/saui-main-registry
  tag: "${IMAGE_TAG}:latest"
  pullPolicy: IfNotPresent

# Replicas for high availability
replicaCount: 2

# Production environment variables
env:
  APP_ENV: "production"
  QUARKUS_PROFILE: "prod"
  QUARKUS_LOG_LEVEL: "INFO"
  LOG_LEVEL: "INFO"
  HIBERNATE_SHOW_SQL: "false"
  
  # Keycloak Production
  KEYCLOAK_AUTH_SERVER_URL: "https://auth.apporte.work/realms/production"
  KEYCLOAK_CLIENT_ID: "workflow-engine-prod"
  KEYCLOAK_REALM: "production"
  
  # CORS for production
  CORS_ORIGINS: "https://app.apporte.work,https://www.apporte.work"

# Resources for production (higher limits)
resources:
  requests:
    memory: "128Mi"
    cpu: "50m"
  limits:
    memory: "256Mi"
    cpu: "100m"

# Autoscaling for production
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 75

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Service Monitor for Prometheus
serviceMonitor:
  enabled: true
  interval: 30s
  path: /q/metrics

# Ingress for production
ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - host: api.apporte.work
      paths:
        - path: /api/workflow
          pathType: Prefix
  tls:
    - secretName: workflow-engine-prod-tls
      hosts:
        - api.apporte.work

# ⚠️  Secrets MUST be injected via --set flags or external secret management
secrets:
  database:
    password: "" # DO NOT commit real values
  keycloak:
    clientSecret: "" # DO NOT commit real values

# Persistence for production logs (optional)
persistence:
  enabled: false
  mountPath: /deployments/logs
  size: 10Gi
  storageClass: "do-block-storage"
