# Application Properties - Production Profile with Supabase
# Use: export QUARKUS_PROFILE=prod && java -jar target/workflow-engine-1.0.0-SNAPSHOT.jar

# Database Configuration (Supabase - from environment variables)
quarkus.datasource.jdbc.url=jdbc:postgresql://db.${SUPABASE_PROJECT_ID}.supabase.co:5432/postgres?sslmode=require
quarkus.datasource.username=workflow_backend
quarkus.datasource.password=${DB_PASSWORD}
quarkus.datasource.jdbc.initial-size=10
quarkus.datasource.jdbc.max-size=50

# JWT Configuration
mp.jwt.verify.publickey.location=${SUPABASE_URL}/auth/v1/certs
mp.jwt.verify.issuer=${JWT_ISSUER:https://${SUPABASE_PROJECT_ID}.supabase.co}
mp.jwt.verify.audiences=${JWT_AUDIENCE:authenticated}
quarkus.smallrye-jwt.enabled=true

# Connection Pooling
quarkus.datasource.jdbc.validation-query=SELECT 1
quarkus.datasource.jdbc.idle-removal-interval=5M
quarkus.datasource.jdbc.max-lifetime=30M

# Hibernate Configuration
quarkus.hibernate-orm.database.generation=validate
quarkus.hibernate-orm.log.sql=false

# Quarkus Application
quarkus.application.name=workflow-service
quarkus.application.version=1.0.0

# Server Configuration
quarkus.http.port=${SERVER_PORT:8080}
quarkus.http.ssl.certificate.files=${SSL_CERT_PATH:}
quarkus.http.ssl.certificate.key-files=${SSL_KEY_PATH:}

# Logging - Production (MÍNIMO)
quarkus.log.level=INFO
quarkus.log.category."com.apporte".level=INFO
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.file.enable=true
quarkus.log.file.path=/var/log/workflow/app.log
quarkus.log.file.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=10

# CORS Configuration (production - específico)
quarkus.http.cors=true
quarkus.http.cors.origins=${CORS_ORIGINS:https://app.production.com}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=Content-Type,Authorization,X-API-Key

# Security Headers
quarkus.http.header.X-Content-Type-Options=nosniff
quarkus.http.header.X-Frame-Options=DENY
quarkus.http.header.X-XSS-Protection=1;mode=block
quarkus.http.header.Strict-Transport-Security=max-age=31536000; includeSubDomains

# Health Checks
quarkus.health.enabled=true
quarkus.smallrye-health.root-path=/q/health

# Metrics
quarkus.micrometer.enabled=true
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics

# Jackson Configuration
quarkus.jackson.serialization-inclusion=NON_NULL
quarkus.jackson.serialize-dates-as-timestamps=false

# External Service Configuration
workflow.api.url=${WORKFLOW_API_URL:http://api.production.com}
notification.service.url=${NOTIFICATION_SERVICE_URL:http://notify.production.com}

# Timeout Configuration
quarkus.http.limits.max-body-size=1M
quarkus.http.so-reuse-address=true

# Performance
quarkus.native.gc=epsilon
quarkus.native.enable-vm-fault-isolation=false