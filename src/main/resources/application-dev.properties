# Application Properties - Development Profile with Supabase
# Use: ./mvnw quarkus:dev -Dquarkus.profile=dev

# Database Configuration (Supabase - Development) - URL FIXA
quarkus.datasource.jdbc.url=jdbc:postgresql://db.rpkqbesfgjdeolketoug.supabase.co:5432/postgres?sslmode=require
quarkus.datasource.username=workflow_backend
quarkus.datasource.password=${DB_PASSWORD}
quarkus.datasource.jdbc.initial-size=5
quarkus.datasource.jdbc.max-size=20

# JWT Configuration
mp.jwt.verify.publickey.location=${SUPABASE_URL}/auth/v1/certs
mp.jwt.verify.issuer=${JWT_ISSUER:https://rpkqbesfgjdeolketoug.supabase.co}
mp.jwt.verify.audiences=${JWT_AUDIENCE:authenticated}
quarkus.smallrye-jwt.enabled=true

# Hibernate Configuration - CORREÇÃO: Remover propriedades depreciadas
quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.bind-param=true
# CORREÇÃO CRÍTICA: Resolve erro de serialização JSON
quarkus.hibernate-orm.mapping.format.global=ignore

# Quarkus Application
quarkus.application.name=workflow-service
quarkus.application.version=1.0.0

# Server Configuration
quarkus.http.port=8080
quarkus.http.test-port=8081

# Logging - Desenvolvimento (MAIS DETALHADO)
quarkus.log.level=DEBUG
quarkus.log.category."com.apporte".level=DEBUG
quarkus.log.category."io.quarkus".level=INFO
quarkus.log.category."org.hibernate".level=DEBUG
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
# CORREÇÃO: Desabilitar log em arquivo em dev (causa problema)
quarkus.log.file.enable=false

# CORS Configuration (desenvolvimento)
quarkus.http.cors=true
quarkus.http.cors.origins=http://localhost:3000,http://localhost:3001
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=Content-Type,Authorization

# Health Checks
quarkus.health.enabled=true
quarkus.smallrye-health.root-path=/q/health

# Metrics (desabilitado em dev para performance)
quarkus.micrometer.enabled=false

# Development Features - CORREÇÃO: Usar propriedade correta
quarkus.devservices.enabled=false
quarkus.live-reload.instrumentation=true

# Jackson Configuration - CORREÇÃO: Usar propriedade correta
quarkus.jackson.serialization-inclusion=NON_NULL
quarkus.jackson.write-dates-as-timestamps=false